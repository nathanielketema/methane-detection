# Methane Leak Detection System

This project implements a machine learning system for detecting and tracking methane leaks using meteorological data generated by RAM (Regional Atmospheric Modeling) and methane concentration data from HYSPLIT (Hybrid Single-Particle Lagrangian Integrated Trajectory model). The system uses a binary classification model to detect methane leaks and a **quantum gaussian process regression (QGPR)** to predict methane concentration levels, which guide drone navigation for dynamic methane mapping.

## Overview

The system provides a comprehensive approach to methane leak detection and monitoring:

### Input Data
- **Meteorological data** generated by RAM (Regional Atmospheric Modeling)
- **Methane concentration data** using HYSPLIT (Hybrid Single-Particle Lagrangian Integrated Trajectory model)

### Process
1. **Binary Classification Model**: Detects the presence or absence of methane leaks
   - Leak present: if methane concentration > 0
   - Leak absent: if methane concentration = 0
2. **Quantum Gaussian Process Regression (QGPR)**: Once a leak is detected, uses quantum computing techniques to predict methane concentration levels with higher accuracy and efficiency than classical models
3. **Drone Navigation**: Uses the output of the QGPR model to determine where the drone should fly next
4. **Dynamic Mapping**: Creates real-time methane concentration maps as data is collected

### Technical Implementation
- The QGPR implementation uses **squlearn** and **qiskit** to perform quantum-enhanced Gaussian process regression
- The model uses a **FidelityKernel** with **HubregtsenEncodingCircuit** for quantum feature mapping
- Simulation is performed using Qiskit's QASM simulator with 1024 shots by default
- Drone navigation is simulated based on uncertainty-guided exploration strategy

## Features

- Data processing and feature engineering for meteorological and methane concentration data
- Binary classification for methane leak detection
- **Quantum Gaussian Process Regression (QGPR)** for superior concentration level prediction
  - Leverages quantum computing principles for improved performance
  - Handles complex, non-linear relationships in meteorological data
  - Provides uncertainty quantification for more reliable predictions
- Intelligent drone navigation system to track methane sources
- Visualization tools for methane distribution patterns
  - Static visualizations (PNG format)
  - Interactive maps (Folium and Plotly)
  - Dynamic dashboards (Dash)
  - Animations of methane concentration over time
- Memory-efficient handling of large datasets
- Model evaluation tools with comprehensive metrics

## Requirements

- Python 3.8+
- Dependencies:
  - Core data processing: pandas, numpy, scipy>=1.8.0
  - Visualization: matplotlib, seaborn, folium, plotly, geopandas
  - Machine learning: scikit-learn
  - Quantum computing: qiskit, qiskit-algorithms, qiskit-aer, qiskit-ibm-runtime, squlearn
  - Interactive dashboards: dash, dash-leaflet
  - Development: ipykernel

For exact versions, see `requirements.txt`

## Project Structure

```plaintext
├── data/
│   ├── raw/             # Raw RAM and HYSPLIT data
│   └── processed/       # Processed and cleaned data
├── src/
│   ├── __init__.py
│   ├── config.py               # Configuration parameters
│   ├── data_processing.py      # Data cleaning and preprocessing
│   ├── feature_engineering.py  # Feature extraction and engineering
│   ├── data_preparation.py     # Prepare data for models
│   ├── drone_navigation.py     # Drone path planning algorithms
│   ├── model_evaluation.py     # Comprehensive model evaluation tools
│   ├── visualization.py        # Data visualization tools
│   └── models/
│       ├── __init__.py
│       ├── methane_leak_classifier.py      # Binary classification model
│       ├── quantum_gaussian_regression.py  # Quantum gaussian process regression (QGPR) model
│       └── predictive_route_planner.py     # Drone route planning
├── examples/              
│   └── model_evaluation_example.py  # Example of model evaluation
├── outputs/               # Model outputs and visualizations
│   ├── confusion_matrix.png
│   ├── roc_curve.png
│   ├── prediction_scatter.png
│   ├── residuals.png
│   ├── geospatial_errors.png
│   └── methane_concentration_map.png
├── models/                # Saved trained models (gitignored)
├── notebook.ipynb         # Jupyter notebook for exploratory data analysis
├── methane_leak_detection.py   # Main execution script
├── requirements.txt       # Project dependencies
├── LICENSE                # Proprietary license
└── README.md              # This file
```

## Installation

1. Clone the repository:

```bash
git clone https://github.com/nathanielketema/methane-leak-detection.git
```

2. Create and activate a virtual environment (recommended):
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

3. Install dependencies:
```bash
pip install -r requirements.txt
```

## Usage

Run the main script:
Normal mode - uses cached model if available
```bash
python methane_leak_detection.py
```
Force retrain mode - retrains the model from scratch
```bash
python methane_leak_detection.py --force-retrain
```

This will:
1. Process the raw meteorological (RAM) and methane concentration (HYSPLIT) data
2. Extract relevant features from the processed data
3. Train the binary classification model to detect methane leaks
4. If leaks are detected, train the **quantum gaussian process regression (QGPR)** to predict concentration levels with high accuracy
5. Simulate drone navigation decisions based on predicted concentrations
6. Generate static and dynamic visualizations of methane distribution

### Outputs

The system generates several outputs in the `outputs/` directory:

- **Methane concentration maps**: Static PNG files showing the spatial distribution of methane
- **Interactive maps**: HTML files with Folium and Plotly-based interactive maps
- **Animations**: MP4 files showing the temporal evolution of methane concentration
- **Model evaluation**: Various plots showing model performance metrics
- **Dashboard code**: Python files to run interactive Dash dashboards

### Examples

Check the `examples/` directory for sample code demonstrating how to use specific components:

```bash
python examples/model_evaluation_example.py
```

## Data Format

The input data should include the following columns:
- Time (UTC)
- Latitude and longitude coordinates
- Meteorological data from RAM:
  - Wind components (u_west_to_east_wind, v_south_to_north_wind)
  - Temperature
  - Pressure
  - Humidity
- Methane concentration data from HYSPLIT (target variable)

## Model Evaluation

The project includes model evaluation tools to assess performance:
- Classification metrics (precision, recall, F1-score, ROC curves)
- Regression metrics (RMSE, MAE, R²) for evaluating the QGPR model
- Comparison between classical and quantum regression approaches
- Spatial error analysis for geographically distributed predictions

### Visualization Examples

The system generates several visualization outputs including:
- Confusion matrices
- ROC curves
- Prediction scatter plots
- Residual analysis
- Geospatial error maps
- Interactive methane concentration maps

## License

Copyright © 2025. All Rights Reserved.

This project and its contents are proprietary and confidential. No part of this project may be reproduced, distributed, or transmitted in any form or by any means, including photocopying, recording, or other electronic or mechanical methods, without the prior written permission of the copyright holder.

Unauthorized copying, modification, distribution, or use of this software is strictly prohibited.

## Contact

nathanielketema@gmail.com

